<html lang="en">

<head>
<meta name="keywords" content="karma,javascript,html5,sugar,sugarlabs,gsoc,ole,nepal">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta charset="utf-8">
<link rel="shortcut icon" href="http://karma.sugarlabs.org/favicon.ico">
<script type="text/javascript" src="jquery.js"></script>
<style type="text/css">
	#Karma { position: relative; }
    #canvasDrawing1 { position: absolute; top: 0px; left: 0px; }
    #canvasTmp { position: absolute; top: 0px; left: 0px; }
	.button { position: absolute; top: 0px; left: 0px; }
</style>

<script type="text/javascript">
$(document).ready(function(){


	
    var canvas = $("#canvas")[0]; //similar to document.getElementById('canvas')
	var canvasTmp = $("#canvasTmp")[0];
	
	var ctxTmp = canvasTmp.getContext("2d"); 
	var ctx    = canvas.getContext("2d"); 
	
	var x,y,x0,y0;
	
	
	//ctxTmp.strokeRect( 10, 70, 310, 150 );
	
	
	var imgErase = new Image();
		imgErase.src= "images/bg.png";
		imgErase.onload = function(){
			ctxTmp.font = "bold 13px sans-serif";
			ctxTmp.fillStyle = "#000000"
		
			ctxTmp.drawImage( imgErase,0 , 0 );
			ctxTmp.fillText (  "Erase", 25, 245 );
		}
		
	var mouse= {x:0, y:0, x0:0, y0:0};
	var debug,d;
	var started;
	function onMouseDown (ev) {
		mouse.x = ev.layerX;
		mouse.y = ev.layerY;
		ctxTmp.moveTo( mouse.x, mouse.y );
		started = true;
	}
	
	function onMouseUp (ev) {
		//started = false;
		mouse.x0 = ev.layerX;
		mouse.y0 = ev.layerY;
		
		ctx.drawImage(canvasTmp, 0, 0);
		ctxTmp.clearRect(0, 0, canvas.width, canvas.height);
	}
	
	function onMouseMove (ev) {
		
	    mouse.x = ev.layerX ;
		mouse.y = ev.layerY;
		
		
		if (started) {
			$("#debug").html( mouse.x +" "+mouse.y );
			ctxTmp.clearRect(0, 0, canvas.width, canvas.height);
			ctxTmp.beginPath();
			ctxTmp.moveTo(mouse.x0, mouse.y0);
			ctxTmp.lineTo(mouse.x,  mouse.y );
			ctxTmp.stroke();
			ctxTmp.closePath();
		}
	}
	canvasTmp.addEventListener('mouseup',   onMouseUp,   false);
	canvasTmp.addEventListener('mousedown', onMouseDown, false);
    canvasTmp.addEventListener('mousemove', onMouseMove, false);
   
	
});
</script>
</head>

<body>

	<noscript>
	Man, you need to enable JavaScript.
	</noscript>
	
	<div id="Karma">
		<canvas id="canvas" width="550" height="400"></canvas>
		<canvas id="canvasDrawing" width="550" height="400"></canvas>
		<canvas id="canvasTmp" width="550" height="400"></canvas>
	</div>
	<div id="debug"> </div>
	
	
</body>
</html>





